@model MovieLibrary.ViewModels.MovieDetailsViewModel
<h1>@Model.Title</h1>
@if (Model.Accepted == false)
{
    <form asp-action="Accept" asp-route-movieId="@Model.Id">
        <button type="submit" class="btn-dark">
            Accept
        </button>
    </form>
    <form asp-action="Delete" asp-route-movieId="@Model.Id">
        <button type="submit" onclick="return confirm('Are you sure you want to decline this movie?')" class="btn btn-danger">
            Decline
        </button>
    </form>
}
<div>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/@Model.YoutubeTrailerId"
            title="YouTube video player" frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
</div>
<h4>Rate the movie:</h4>
<p>@Model.Rating/@Model.UsersRated</p>
<form asp-action="Rate" method="post" asp-route-movieId="@Model.Id">
    <div class="rating">
        <input type="radio" id="star1" name="rate" value="1" />
        <label for="star1"></label>
        <input type="radio" id="star2" name="rate" value="2" />
        <label for="star2"></label>
        <input type="radio" id="star3" name="rate" value="3" />
        <label for="star3"></label>
        <input type="radio" id="star4" name="rate" value="4" />
        <label for="star4"></label>
        <input type="radio" id="star5" name="rate" value="5" />
        <label for="star5"></label>
    </div>
    <input type="submit" value="Rate" />
</form>


<form asp-action="Comment">
    <input asp-for="@Model.Id" hidden />
    <input asp-for="@Model.Comments" hidden />
    <div class="form-group">
        <label asp-for="Comment" class="col-md-2"></label>
        <div class="col-md-10">
            <textarea asp-for="Comment" class="form-control">Write a description of the movie.</textarea>
            <span asp-validation-for="Comment" class="text-danger"></span>
        </div>
    </div>
    <input type="submit" value="Save" class="btn btn-primary" />
</form>

@if (Model.Comments is not null)
{
    @foreach (var comment in Model.Comments)
    {
        <div>
            @comment.Text
            <form asp-action="DeleteComment" asp-route-commentId="@comment.Id">
                <button type="submit" onclick="return confirm('Are you sure you want to delete this comment?')"
                        class="btn btn-danger">
                    Delete
                </button>
            </form>
            @if ((@DateTime.Now.Minute - @comment.PostedTime.Minute) <= 59 && (@DateTime.Now.Minute - @comment.PostedTime.Minute) > 0)
            {
                <div>
                    @(DateTime.Now.Minute - @comment.PostedTime.Minute) mins ago
                </div>
            }
            @if ((@DateTime.Now.Hour - @comment.PostedTime.Hour) <= 23 && (@DateTime.Now.Hour - @comment.PostedTime.Hour) > 0)
            {
                <div>
                    @(DateTime.Now.Hour - @comment.PostedTime.Hour) hours ago
                </div>
            }
            @if ((@DateTime.Now.Day - @comment.PostedTime.Day) <= 364 && (@DateTime.Now.Day - @comment.PostedTime.Day) > 0)
            {
                <div>
                    @(DateTime.Now.Day - @comment.PostedTime.Day) days ago
                </div>
            }
            @if ((@DateTime.Now.Year - @comment.PostedTime.Year) >= 1 && (@DateTime.Now.Year - @comment.PostedTime.Year) > 0)
            {
                <div>
                    @(DateTime.Now.Year - @comment.PostedTime.Year) years ago
                </div>
            }
        </div>
    }
}
<style>
    .rating {
        direction: rtl;
        display: inline-block;
    }

        .rating input {
            display: none;
        }

        .rating label {
            float: right;
            width: 24px;
            height: 24px;
            background-image: url(star.png);
            background-size: cover;
        }

        .rating input:checked + label {
            background-image: url(star-filled.png);
        }
</style>